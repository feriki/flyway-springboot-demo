CREATE TABLE `DICT_CACHE_DEF` (
                                  `TID` int(11) NOT NULL AUTO_INCREMENT,
                                  `CACHE_NAME` varchar(32) NOT NULL COMMENT '缓存名称(可存储表名称)',
                                  `DATABASE_TYPE` varchar(32) NOT NULL DEFAULT 'mysql' COMMENT '数据库类型: mysql',
                                  `HOSTS` varchar(128) DEFAULT NULL COMMENT '主机IP,多个用逗号分开',
                                  `PORT` int(11) DEFAULT NULL COMMENT '端口',
                                  `USER_NAME` varchar(32) DEFAULT NULL COMMENT '用户名',
                                  `PASSWORD` varchar(64) DEFAULT NULL COMMENT '密码',
                                  `KEY_NAME` varchar(32) DEFAULT NULL COMMENT '使用KEY_NAME获取记录的其它属性，如DEVICE_ID',
                                  `TOTAL_PARAMS` varchar(2048) DEFAULT NULL COMMENT '全量获取的参数定义,包含条件，是json对象',
                                  `INCREMENTAL_PARAMS` varchar(2048) DEFAULT NULL COMMENT '增量获取的参数定义，包含条件，是json对象',
                                  `REFRESH_INTERVAL` int(11) NOT NULL DEFAULT '900' COMMENT '刷新频率，单位:秒',
                                  `DATABASENAME` varchar(128) DEFAULT NULL COMMENT '数据库名称',
                                  PRIMARY KEY (`TID`) USING BTREE,
                                  UNIQUE KEY `IDX_CACHE_DEF_CACHE_NAME` (`CACHE_NAME`)
) ENGINE=InnoDB AUTO_INCREMENT=12 DEFAULT CHARSET=utf8 COMMENT=' 基础信息缓存定义表';

INSERT INTO `DICT_CACHE_DEF` VALUES ('6', 'WIFI', 'MySql', 'mysql.v-base', '3306', 'a', 'b', 'DEVICE_ID', '{\"sql\":\"SELECT a.WIFI_ID AS DEVICE_ID, a.SOURCE_WIFIID AS ORIGINAL_DEVICE_ID, a.WIFI_NAME AS DEVICE_NAME, a.INSTALL_ADDR AS DEVICE_ADDR,sd.SCENE_ID FROM pd_res.RS_WIFI a left join pd_vplusplat.SCENE_DEVICE sd on a.WIFI_ID = sd.DEVICE_ID\"}', '{\"sql\":\"SELECT a.WIFI_ID AS DEVICE_ID, a.SOURCE_WIFIID AS ORIGINAL_DEVICE_ID, a.WIFI_NAME AS DEVICE_NAME, a.INSTALL_ADDR AS DEVICE_ADDR,sd.SCENE_ID FROM pd_res.RS_WIFI a left join pd_vplusplat.SCENE_DEVICE sd on a.WIFI_ID = sd.DEVICE_ID WHERE a.UPDATE_TIME >= @updateTime\"}', '900', 'pd_res');
INSERT INTO `DICT_CACHE_DEF` VALUES ('7', 'ACCESS_DOOR', 'MySql', 'mysql.v-base', '3306', 'a', 'b', 'DEVICE_ID', '{\"sql\":\"SELECT a.DEVICE_ID, a.SOURCE_DEVICEID AS ORIGINAL_DEVICE_ID, a.DEVICE_NAME, a.INSTALL_ADDR AS DEVICE_ADDR,sd.SCENE_ID FROM pd_res.RS_ACCESS_DOOR a left join pd_vplusplat.SCENE_DEVICE sd ON a.DEVICE_ID = sd.DEVICE_ID\"}', '{\"sql\":\"SELECT a.DEVICE_ID, a.SOURCE_DEVICEID AS ORIGINAL_DEVICE_ID, a.DEVICE_NAME, a.INSTALL_ADDR AS DEVICE_ADDR,sd.SCENE_ID FROM pd_res.RS_ACCESS_DOOR a left join pd_vplusplat.SCENE_DEVICE sd ON a.DEVICE_ID = sd.DEVICE_ID WHERE a.UPDATE_TIME >= @updateTime\"}', '900', 'pd_res');
INSERT INTO `DICT_CACHE_DEF` VALUES ('8', 'ELECFENSE', 'MySql', 'mysql.v-base', '3306', 'a', 'b', 'DEVICE_ID', '{\"sql\":\"SELECT a.DWBM AS DEVICE_ID, a.SOURCE_DWBM AS ORIGINAL_DEVICE_ID, a.DWMC AS DEVICE_NAME, a.AZDZ AS ADDRESS,sd.SCENE_ID FROM pd_res.RS_ELECFENSE a left join pd_vplusplat.SCENE_DEVICE sd ON a.DWBM=sd.DEVICE_ID\"}', '{\"sql\":\"SELECT a.DWBM AS DEVICE_ID, a.SOURCE_DWBM AS ORIGINAL_DEVICE_ID, a.DWMC AS DEVICE_NAME, a.AZDZ AS ADDRESS,sd.SCENE_ID FROM pd_res.RS_ELECFENSE a left join pd_vplusplat.SCENE_DEVICE sd ON a.DWBM=sd.DEVICE_ID WHERE a.UPDATE_TIME >= @updateTime\"}', '900', 'pd_res');
INSERT INTO `DICT_CACHE_DEF` VALUES ('9', 'KAKOU', 'MySql', 'mysql.v-base', '3306', 'a', 'b', 'TOLLGATE_ID', '{\"sql\":\"SELECT t.*, sd.SCENE_ID FROM ( SELECT ltable.SXJSBBM AS DEVICE_ID, ktable.KKBH AS ORIGINAL_DEVICE_ID, ktable.KKBH AS TOLLGATE_ID, ktable.YKKBH AS ORIGINAL_TOLLGATE_ID, ktable.KKMC AS TOLLGATE_NAME , ktable.XZQH AS ORG_CODE, ktable.ZDCS AS VENDOR, FROM pd_res.RS_KAKOU ktable, pd_res.RS_LANE ltable WHERE ktable.KKBH = ltable.KKBH ) t LEFT JOIN pd_vplusplat.SCENE_DEVICE sd ON t.DEVICE_ID = sd.DEVICE_ID\"}', '{\"sql\":\"SELECT t.*, sd.SCENE_ID FROM ( SELECT ltable.SXJSBBM AS DEVICE_ID FROM pd_res.RS_KAKOU ktable, pd_res.RS_LANE ltable WHERE ktable.KKBH = ltable.KKBH AND ktable.UPDATE_TIME>=@updateTime ) t LEFT JOIN pd_vplusplat.SCENE_DEVICE sd ON t.DEVICE_ID = sd.DEVICE_ID\"}', '900', 'pd_res');
INSERT INTO `DICT_CACHE_DEF` VALUES ('10', 'CAMERA', 'MySql', 'mysql.v-base', '3306', 'a', 'b', 'DEVICE_ID', '{\"sql\":\"SELECT t.*, b.SCENE_ID FROM ( SELECT pd_res.RM_VIDEODEV_INFO.VIDEODEV_GB_ID AS DEVICE_ID, pd_res.RM_VIDEODEV_INFO.ORIGINAL_DEVICE_ID AS ORIGINAL_DEVICE_ID, pd_res.RM_VIDEODEV_INFO.DEVICE_NAME AS DEVICE_NAME, pd_res.RM_VIDEODEV_INFO.ADMINAREA_GB_CODE AS ORG_CODE FROM pd_res.RM_VIDEODEV_INFO WHERE pd_res.RM_VIDEODEV_INFO.DEVICE_SPEICALTYPE_DICT = 2 UNION ALL SELECT a.DEVICE_ID, a.SOURCE_DEVICEID AS ORIGINAL_DEVICE_ID, a.DEVICE_NAME, INSTALL_ADDR AS DEVICE_ADDR, a.ORG_CODE , LONGITUDE, LATITUDE, a.MANUFACTURER AS MANUFACTURER FROM pd_res.RS_ACCESS_DOOR a WHERE a.VIDEO_FUNCTION = 1 ) t LEFT JOIN pd_vplusplat.SCENE_DEVICE b ON t.DEVICE_ID = b.DEVICE_ID\"}', '{\"sql\":\"SELECT t.*, b.SCENE_ID FROM ( SELECT pd_res.RM_VIDEODEV_INFO.VIDEODEV_GB_ID AS DEVICE_ID FROM pd_res.RM_VIDEODEV_INFO WHERE pd_res.RM_VIDEODEV_INFO.DEVICE_SPEICALTYPE_DICT = 2 AND pd_res.RM_VIDEODEV_INFO.UPDATE_TIME >= @updateTime UNION ALL SELECT a.DEVICE_ID, a.SOURCE_DEVICEID AS ORIGINAL_DEVICE_ID, a.DEVICE_NAME, INSTALL_ADDR AS DEVICE_ADDR, a.ORG_CODE , LONGITUDE, LATITUDE, a.MANUFACTURER AS MANUFACTURER FROM pd_res.RS_ACCESS_DOOR a WHERE a.VIDEO_FUNCTION = 1 AND a.UPDATE_TIME >= @updateTime ) t LEFT JOIN SCENE_DEVICE b ON t.DEVICE_ID = b.DEVICE_ID\"}', '900', 'pd_res');
INSERT INTO `DICT_CACHE_DEF` VALUES ('11', 'DEVICE_REV_KAKOU', 'MySql', 'mysql.v-base', '3306', 'a', 'b', 'DEVICE_ID', '{\"sql\":\"SELECT t.*, sd.SCENE_ID FROM ( SELECT ltable.SXJSBBM AS DEVICE_ID, ktable.KKBH AS ORIGINAL_DEVICE_ID FROM pd_res.RS_KAKOU ktable, pd_res.RS_LANE ltable WHERE ktable.KKBH = ltable.KKBH ) t LEFT JOIN pd_vplusplat.SCENE_DEVICE sd ON t.DEVICE_ID = sd.DEVICE_ID\"}', '{\"sql\":\"SELECT t.*, sd.SCENE_ID FROM ( SELECT ltable.SXJSBBM AS DEVICE_ID, ktable.KKBH AS ORIGINAL_DEVICE_ID FROM pd_res.RS_KAKOU ktable, pd_res.RS_LANE ltable WHERE ktable.KKBH = ltable.KKBH AND ktable.UPDATE_TIME>=@updateTime ) t LEFT JOIN pd_vplusplat.SCENE_DEVICE sd ON t.DEVICE_ID = sd.DEVICE_ID\"}', '900', 'pd_res');
UPDATE `DICT_CACHE_DEF` SET `INCREMENTAL_PARAMS` = '{\"sql\":\"SELECT t.*, b.SCENE_ID FROM ( SELECT pd_res.RM_VIDEODEV_INFO.VIDEODEV_GB_ID AS DEVICE_ID FROM pd_res.RM_VIDEODEV_INFO WHERE pd_res.RM_VIDEODEV_INFO.DEVICE_SPEICALTYPE_DICT = 2 AND pd_res.RM_VIDEODEV_INFO.UPDATE_TIME >= @updateTime UNION ALL SELECT a.DEVICE_ID, a.SOURCE_DEVICEID AS ORIGINAL_DEVICE_ID FROM pd_res.RS_ACCESS_DOOR a WHERE a.VIDEO_FUNCTION = 1 AND a.UPDATE_TIME >= @updateTime ) t LEFT JOIN pd_vplusplat.SCENE_DEVICE b ON t.DEVICE_ID = b.DEVICE_ID\"}', `REFRESH_INTERVAL` = 900, `DATABASENAME` = 'pd_res' WHERE `CACHE_NAME` = 'CAMERA';